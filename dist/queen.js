/*! queen - v0.4.0 - 2013-01-20
* http://queenjs.com
* Copyright (c) 2013 Ozan Turgut; Licensed Apache License 2.0 */
Queen=function(){var e=function(e,t){return e.exports=t,function(){function N(t){var n,r,s,u='{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',a=t=="json";if(a||t=="json-stringify"||t=="json-parse"){if(t=="json-stringify"||a){if(n=typeof o.stringify=="function"&&w){(s=function(){return 1}).toJSON=s;try{n=o.stringify(0)==="0"&&o.stringify(new Number)==="0"&&o.stringify(new String)=='""'&&o.stringify(e)===i&&o.stringify(i)===i&&o.stringify()===i&&o.stringify(s)==="1"&&o.stringify([s])=="[1]"&&o.stringify([i])=="[null]"&&o.stringify(null)=="null"&&o.stringify([i,e,null])=="[null,null,null]"&&o.stringify({A:[s,true,false,null,"\0\b\n\f\r	"]})==u&&o.stringify(null,s)==="1"&&o.stringify([1,2],null,1)=="[\n 1,\n 2\n]"&&o.stringify(new Date(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&o.stringify(new Date(864e13))=='"+275760-09-13T00:00:00.000Z"'&&o.stringify(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&o.stringify(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(f){n=!1}}if(!a)return n}if(t=="json-parse"||a){if(typeof o.parse=="function")try{if(o.parse("0")===0&&!o.parse(!1)){s=o.parse(u);if(r=s.A.length==5&&s.A[0]==1){try{r=!o.parse('"	"')}catch(f){}if(r)try{r=o.parse("01")!=1}catch(f){}}}}catch(f){r=!1}if(!a)return r}return n&&r}}var e={}.toString,n,r,i,s=typeof define=="function"&&define.amd,o=!s&&typeof t=="object"&&t;o||s?typeof JSON=="object"&&JSON?s?o=JSON:(o.stringify=JSON.stringify,o.parse=JSON.parse):s&&(o=this.JSON={}):o=this.JSON||(this.JSON={});var u,a,f,l,c,h,p,d,v,m,g,y,b,w=new Date(-0xc782b5b800cec),E,S,x;try{w=w.getUTCFullYear()==-109252&&w.getUTCMonth()===0&&w.getUTCDate()==1&&w.getUTCHours()==10&&w.getUTCMinutes()==37&&w.getUTCSeconds()==6&&w.getUTCMilliseconds()==708}catch(T){}N("json")||(w||(E=Math.floor,S=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(e,t){return S[t]+365*(e-1970)+E((e-1969+(t=+(t>1)))/4)-E((e-1901+t)/100)+E((e-1601+t)/400)}),(n={}.hasOwnProperty)||(n=function(t){var r={},i;return(r.__proto__=null,r.__proto__={toString:1},r).toString!=e?n=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(i=r.constructor,n=function(e){var t=(this.constructor||i).prototype;return e in this&&!(e in t&&this[e]===t[e])}),r=null,n.call(this,t)}),r=function(t,r){var i=0,s,o,u,a;(s=function(){this.valueOf=0}).prototype.valueOf=0,o=new s;for(u in o)n.call(o,u)&&i++;return s=o=null,i?i==2?a=function(t,r){var i={},s=e.call(t)=="[object Function]",o;for(o in t)(!s||o!="prototype")&&!n.call(i,o)&&(i[o]=1)&&n.call(t,o)&&r(o)}:a=function(t,r){var i=e.call(t)=="[object Function]",s,o;for(s in t)(!i||s!="prototype")&&n.call(t,s)&&!(o=s==="constructor")&&r(s);(o||n.call(t,s="constructor"))&&r(s)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],a=function(t,r){var i=e.call(t)=="[object Function]",s,u;for(s in t)(!i||s!="prototype")&&n.call(t,s)&&r(s);for(u=o.length;s=o[--u];n.call(t,s)&&r(s));}),a(t,r)},N("json-stringify")||(u={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},a=function(e,t){return("000000"+(t||0)).slice(-e)},f=function(e){var t='"',n=0,r;for(;r=e.charAt(n);n++)t+='\\"\b\f\n\r	'.indexOf(r)>-1?u[r]:u[r]=r<" "?"\\u00"+a(2,r.charCodeAt(0).toString(16)):r;return t+'"'},l=function(t,s,o,u,c,h,p){var d=s[t],v,m,g,y,b,w,S,T,N,C,k,L,A,O,M,_;if(typeof d=="object"&&d){v=e.call(d);if(v=="[object Date]"&&!n.call(d,"toJSON"))if(d>-1/0&&d<1/0){if(x){y=E(d/864e5);for(m=E(y/365.2425)+1970-1;x(m+1,0)<=y;m++);for(g=E((y-x(m,0))/30.42);x(m,g+1)<=y;g++);y=1+y-x(m,g),b=(d%864e5+864e5)%864e5,w=E(b/36e5)%24,S=E(b/6e4)%60,T=E(b/1e3)%60,N=b%1e3}else m=d.getUTCFullYear(),g=d.getUTCMonth(),y=d.getUTCDate(),w=d.getUTCHours(),S=d.getUTCMinutes(),T=d.getUTCSeconds(),N=d.getUTCMilliseconds();d=(m<=0||m>=1e4?(m<0?"-":"+")+a(6,m<0?-m:m):a(4,m))+"-"+a(2,g+1)+"-"+a(2,y)+"T"+a(2,w)+":"+a(2,S)+":"+a(2,T)+"."+a(3,N)+"Z"}else d=null;else typeof d.toJSON=="function"&&(v!="[object Number]"&&v!="[object String]"&&v!="[object Array]"||n.call(d,"toJSON"))&&(d=d.toJSON(t))}o&&(d=o.call(s,t,d));if(d===null)return"null";v=e.call(d);if(v=="[object Boolean]")return""+d;if(v=="[object Number]")return d>-1/0&&d<1/0?""+d:"null";if(v=="[object String]")return f(d);if(typeof d=="object"){for(A=p.length;A--;)if(p[A]===d)throw TypeError();p.push(d),C=[],O=h,h+=c;if(v=="[object Array]"){for(L=0,A=d.length;L<A;M||(M=!0),L++)k=l(L,d,o,u,c,h,p),C.push(k===i?"null":k);_=M?c?"[\n"+h+C.join(",\n"+h)+"\n"+O+"]":"["+C.join(",")+"]":"[]"}else r(u||d,function(e){var t=l(e,d,o,u,c,h,p);t!==i&&C.push(f(e)+":"+(c?" ":"")+t),M||(M=!0)}),_=M?c?"{\n"+h+C.join(",\n"+h)+"\n"+O+"}":"{"+C.join(",")+"}":"{}";return p.pop(),_}},o.stringify=function(t,n,r){var i,s,o,u,a,f;if(typeof n=="function"||typeof n=="object"&&n)if(e.call(n)=="[object Function]")s=n;else if(e.call(n)=="[object Array]"){o={};for(u=0,a=n.length;u<a;f=n[u++],(e.call(f)=="[object String]"||e.call(f)=="[object Number]")&&(o[f]=1));}if(r)if(e.call(r)=="[object Number]"){if((r-=r%1)>0)for(i="",r>10&&(r=10);i.length<r;i+=" ");}else e.call(r)=="[object String]"&&(i=r.length<=10?r:r.slice(0,10));return l("",(f={},f[""]=t,f),s,o,i,"",[])}),N("json-parse")||(c=String.fromCharCode,h={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"	",n:"\n",f:"\f",r:"\r"},p=function(){throw y=b=null,SyntaxError()},d=function(){var e=b,t=e.length,n,r,i,s,o;while(y<t){n=e.charAt(y);if("	\r\n ".indexOf(n)>-1)y++;else{if("{}[]:,".indexOf(n)>-1)return y++,n;if(n=='"'){for(r="@",y++;y<t;){n=e.charAt(y);if(n<" ")p();else if(n=="\\"){n=e.charAt(++y);if('\\"/btnfr'.indexOf(n)>-1)r+=h[n],y++;else if(n=="u"){i=++y;for(s=y+4;y<s;y++)n=e.charAt(y),n>="0"&&n<="9"||n>="a"&&n<="f"||n>="A"&&n<="F"||p();r+=c("0x"+e.slice(i,y))}else p()}else{if(n=='"')break;r+=n,y++}}if(e.charAt(y)=='"')return y++,r;p()}else{i=y,n=="-"&&(o=!0,n=e.charAt(++y));if(n>="0"&&n<="9"){n=="0"&&(n=e.charAt(y+1),n>="0"&&n<="9")&&p(),o=!1;for(;y<t&&(n=e.charAt(y),n>="0"&&n<="9");y++);if(e.charAt(y)=="."){s=++y;for(;s<t&&(n=e.charAt(s),n>="0"&&n<="9");s++);s==y&&p(),y=s}n=e.charAt(y);if(n=="e"||n=="E"){n=e.charAt(++y),(n=="+"||n=="-")&&y++;for(s=y;s<t&&(n=e.charAt(s),n>="0"&&n<="9");s++);s==y&&p(),y=s}return+e.slice(i,y)}o&&p();if(e.slice(y,y+4)=="true")return y+=4,!0;if(e.slice(y,y+5)=="false")return y+=5,!1;if(e.slice(y,y+4)=="null")return y+=4,null;p()}}}return"$"},v=function(e){var t,n,r;e=="$"&&p();if(typeof e=="string"){if(e.charAt(0)=="@")return e.slice(1);if(e=="["){t=[];for(;;n||(n=!0)){e=d();if(e=="]")break;n&&(e==","?(e=d(),e=="]"&&p()):p()),e==","&&p(),t.push(v(e))}return t}if(e=="{"){t={};for(;;n||(n=!0)){e=d();if(e=="}")break;n&&(e==","?(e=d(),e=="}"&&p()):p()),(e==","||typeof e!="string"||e.charAt(0)!="@"||d()!=":")&&p(),t[e.slice(1)]=v(d())}return t}p()}return e},g=function(e,t,n){var r=m(e,t,n);r===i?delete e[t]:e[t]=r},m=function(t,n,i){var s=t[n],o;if(typeof s=="object"&&s)if(e.call(s)=="[object Array]")for(o=s.length;o--;)g(s,o,i);else r(s,function(e){g(s,e,i)});return i.call(t,n,s)},o.parse=function(t,n){var r,i;return y=0,b=t,r=v(d()),d()!="$"&&p(),y=b=null,n&&e.call(n)=="[object Function]"?m((i={},i[""]=r,i),"",n):r})),s&&define(function(){return o})}.call(this),e.exports}({},{}),t=function(e,t){return e.exports=t,window.Modernizr=function(e,t,n){function A(e){f.cssText=e}function O(e,t){return A(p.join(e+";")+(t||""))}function M(e,t){return typeof e===t}function _(e,t){return!!~(""+e).indexOf(t)}function D(e,t){for(var r in e){var i=e[r];if(!_(i,"-")&&f[i]!==n)return t=="pfx"?i:!0}return!1}function P(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:M(s,"function")?s.bind(r||t):s}return!1}function H(e,t,n){var r=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+v.join(r+" ")+r).split(" ");return M(t,"string")||M(t,"undefined")?D(i,t):(i=(e+" "+m.join(r+" ")+r).split(" "),P(i,t,n))}function B(){i.input=function(n){for(var r=0,i=n.length;r<i;r++)w[n[r]]=n[r]in l;return w.list&&(w.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),w}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),i.inputtypes=function(e){for(var r=0,i,s,u,a=e.length;r<a;r++)l.setAttribute("type",s=e[r]),i=l.type!=="text",i&&(l.value=c,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&l.style.WebkitAppearance!==n?(o.appendChild(l),u=t.defaultView,i=u.getComputedStyle&&u.getComputedStyle(l,null).WebkitAppearance!=="textfield"&&l.offsetHeight!==0,o.removeChild(l)):/^(search|tel)$/.test(s)||(/^(url|email)$/.test(s)?i=l.checkValidity&&l.checkValidity()===!1:i=l.value!=c)),b[e[r]]=!!i;return b}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var r="2.6.2",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l=t.createElement("input"),c=":)",h={}.toString,p=" -webkit- -moz- -o- -ms- ".split(" "),d="Webkit Moz O ms",v=d.split(" "),m=d.toLowerCase().split(" "),g={svg:"http://www.w3.org/2000/svg"},y={},b={},w={},E=[],S=E.slice,x,T=function(e,n,r,i){var s,a,f,l,c=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),c.appendChild(f);return s=["&#173;",'<style id="s',u,'">',e,"</style>"].join(""),c.id=u,(h?c:p).innerHTML+=s,p.appendChild(c),h||(p.style.background="",p.style.overflow="hidden",l=o.style.overflow,o.style.overflow="hidden",o.appendChild(p)),a=n(c,e),h?c.parentNode.removeChild(c):(p.parentNode.removeChild(p),o.style.overflow=l),!!a},N=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var r;return T("@media "+t+" { #"+u+" { position: absolute; } }",function(t){r=(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle)["position"]=="absolute"}),r},C=function(){function r(r,i){i=i||t.createElement(e[r]||"div"),r="on"+r;var s=r in i;return s||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(r,""),s=M(i[r],"function"),M(i[r],"undefined")||(i[r]=n),i.removeAttribute(r))),i=null,s}var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r}(),k={}.hasOwnProperty,L;!M(k,"undefined")&&!M(k.call,"undefined")?L=function(e,t){return k.call(e,t)}:L=function(e,t){return t in e&&M(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=S.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(S.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(S.call(arguments)))};return i}),y.flexbox=function(){return H("flexWrap")},y.flexboxlegacy=function(){return H("boxDirection")},y.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},y.canvastext=function(){return!!i.canvas&&!!M(t.createElement("canvas").getContext("2d").fillText,"function")},y.webgl=function(){return!!e.WebGLRenderingContext},y.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:T(["@media (",p.join("touch-enabled),("),u,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},y.geolocation=function(){return"geolocation"in navigator},y.postmessage=function(){return!!e.postMessage},y.websqldatabase=function(){return!!e.openDatabase},y.indexedDB=function(){return!!H("indexedDB",e)},y.hashchange=function(){return C("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},y.history=function(){return!!e.history&&!!history.pushState},y.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},y.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},y.rgba=function(){return A("background-color:rgba(150,255,150,.5)"),_(f.backgroundColor,"rgba")},y.hsla=function(){return A("background-color:hsla(120,40%,100%,.5)"),_(f.backgroundColor,"rgba")||_(f.backgroundColor,"hsla")},y.multiplebgs=function(){return A("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(f.background)},y.backgroundsize=function(){return H("backgroundSize")},y.borderimage=function(){return H("borderImage")},y.borderradius=function(){return H("borderRadius")},y.boxshadow=function(){return H("boxShadow")},y.textshadow=function(){return t.createElement("div").style.textShadow===""},y.opacity=function(){return O("opacity:.55"),/^0.55$/.test(f.opacity)},y.cssanimations=function(){return H("animationName")},y.csscolumns=function(){return H("columnCount")},y.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return A((e+"-webkit- ".split(" ").join(t+e)+p.join(n+e)).slice(0,-e.length)),_(f.backgroundImage,"gradient")},y.cssreflections=function(){return H("boxReflect")},y.csstransforms=function(){return!!H("transform")},y.csstransforms3d=function(){var e=!!H("perspective");return e&&"webkitPerspective"in o.style&&T("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t,n){e=t.offsetLeft===9&&t.offsetHeight===3}),e},y.csstransitions=function(){return H("transition")},y.fontface=function(){var e;return T('@font-face {font-family:"font";src:url("https://")}',function(n,r){var i=t.getElementById("smodernizr"),s=i.sheet||i.styleSheet,o=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"";e=/src/i.test(o)&&o.indexOf(r.split(" ")[0])===0}),e},y.generatedcontent=function(){var e;return T(["#",u,"{font:0/0 a}#",u,':after{content:"',c,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},y.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n},y.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(r){}return n},y.localstorage=function(){try{return localStorage.setItem(u,u),localStorage.removeItem(u),!0}catch(e){return!1}},y.sessionstorage=function(){try{return sessionStorage.setItem(u,u),sessionStorage.removeItem(u),!0}catch(e){return!1}},y.webworkers=function(){return!!e.Worker},y.applicationcache=function(){return!!e.applicationCache},y.svg=function(){return!!t.createElementNS&&!!t.createElementNS(g.svg,"svg").createSVGRect},y.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==g.svg},y.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(h.call(t.createElementNS(g.svg,"animate")))},y.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(h.call(t.createElementNS(g.svg,"clipPath")))};for(var j in y)L(y,j)&&(x=j.toLowerCase(),i[x]=y[j](),E.push((i[x]?"":"no-")+x));return i.input||B(),i.addTest=function(e,t){if(typeof e=="object")for(var r in e)L(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return i;t=typeof t=="function"?t():t,typeof s!="undefined"&&s&&(o.className+=" "+(t?"":"no-")+e),i[e]=t}return i},A(""),a=l=null,function(e,t){function l(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function c(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function h(e){var t=a[e[o]];return t||(t={},u++,e[o]=u,a[u]=t),t}function p(e,n,s){n||(n=t);if(f)return n.createElement(e);s||(s=h(n));var o;return s.cache[e]?o=s.cache[e].cloneNode():i.test(e)?o=(s.cache[e]=s.createElem(e)).cloneNode():o=s.createElem(e),o.canHaveChildren&&!r.test(e)?s.frag.appendChild(o):o}function d(e,n){e||(e=t);if(f)return e.createDocumentFragment();n=n||h(e);var r=n.frag.cloneNode(),i=0,s=c(),o=s.length;for(;i<o;i++)r.createElement(s[i]);return r}function v(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?p(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function m(e){e||(e=t);var n=h(e);return g.shivCSS&&!s&&!n.hasCSS&&(n.hasCSS=!!l(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),f||v(e,n),e}var n=e.html5||{},r=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,i=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,s,o="_html5shiv",u=0,a={},f;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",s="hidden"in e,f=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){s=!0,f=!0}})();var g={elements:n.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:n.shivCSS!==!1,supportsUnknownElements:f,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:m,createElement:p,createDocumentFragment:d};e.html5=g,m(t)}(this,t),i._version=r,i._prefixes=p,i._domPrefixes=m,i._cssomPrefixes=v,i.mq=N,i.hasEvent=C,i.testProp=function(e){return D([e])},i.testAllProps=H,i.testStyles=T,i.prefixed=function(e,t,n){return t?H(e,t,n):H(e,"pfx")},o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+E.join(" "):""),i}(this,this.document),e.exports}({},{}),n=function(e,t){return e.exports=t,function(){var n=this,r=n._,i={},s=Array.prototype,o=Object.prototype,u=Function.prototype,a=s.push,f=s.slice,l=s.concat,c=o.toString,h=o.hasOwnProperty,p=s.forEach,d=s.map,v=s.reduce,m=s.reduceRight,g=s.filter,y=s.every,b=s.some,w=s.indexOf,E=s.lastIndexOf,S=Array.isArray,x=Object.keys,T=u.bind,N=function(e){if(e instanceof N)return e;if(!(this instanceof N))return new N(e);this._wrapped=e};typeof t!="undefined"?(typeof e!="undefined"&&e.exports&&(t=e.exports=N),t._=N):n._=N,N.VERSION="1.4.3";var C=N.each=N.forEach=function(e,t,n){if(e==null)return;if(p&&e.forEach===p)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,s=e.length;r<s;r++)if(t.call(n,e[r],r,e)===i)return}else for(var o in e)if(N.has(e,o)&&t.call(n,e[o],o,e)===i)return};N.map=N.collect=function(e,t,n){var r=[];return e==null?r:d&&e.map===d?e.map(t,n):(C(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var k="Reduce of empty array with no initial value";N.reduce=N.foldl=N.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduce===v)return r&&(t=N.bind(t,r)),i?e.reduce(t,n):e.reduce(t);C(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(k);return n},N.reduceRight=N.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(m&&e.reduceRight===m)return r&&(t=N.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=N.keys(e);s=o.length}C(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(k);return n},N.find=N.detect=function(e,t,n){var r;return L(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},N.filter=N.select=function(e,t,n){var r=[];return e==null?r:g&&e.filter===g?e.filter(t,n):(C(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},N.reject=function(e,t,n){return N.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},N.every=N.all=function(e,t,n){t||(t=N.identity);var r=!0;return e==null?r:y&&e.every===y?e.every(t,n):(C(e,function(e,s,o){if(!(r=r&&t.call(n,e,s,o)))return i}),!!r)};var L=N.some=N.any=function(e,t,n){t||(t=N.identity);var r=!1;return e==null?r:b&&e.some===b?e.some(t,n):(C(e,function(e,s,o){if(r||(r=t.call(n,e,s,o)))return i}),!!r)};N.contains=N.include=function(e,t){return e==null?!1:w&&e.indexOf===w?e.indexOf(t)!=-1:L(e,function(e){return e===t})},N.invoke=function(e,t){var n=f.call(arguments,2);return N.map(e,function(e){return(N.isFunction(t)?t:e[t]).apply(e,n)})},N.pluck=function(e,t){return N.map(e,function(e){return e[t]})},N.where=function(e,t){return N.isEmpty(t)?[]:N.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},N.max=function(e,t,n){if(!t&&N.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&N.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return C(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},N.min=function(e,t,n){if(!t&&N.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&N.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return C(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},N.shuffle=function(e){var t,n=0,r=[];return C(e,function(e){t=N.random(n++),r[n-1]=r[t],r[t]=e}),r};var A=function(e){return N.isFunction(e)?e:function(t){return t[e]}};N.sortBy=function(e,t,n){var r=A(t);return N.pluck(N.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var O=function(e,t,n,r){var i={},s=A(t||N.identity);return C(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};N.groupBy=function(e,t,n){return O(e,t,n,function(e,t,n){(N.has(e,t)?e[t]:e[t]=[]).push(n)})},N.countBy=function(e,t,n){return O(e,t,n,function(e,t){N.has(e,t)||(e[t]=0),e[t]++})},N.sortedIndex=function(e,t,n,r){n=n==null?N.identity:A(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},N.toArray=function(e){return e?N.isArray(e)?f.call(e):e.length===+e.length?N.map(e,N.identity):N.values(e):[]},N.size=function(e){return e==null?0:e.length===+e.length?e.length:N.keys(e).length},N.first=N.head=N.take=function(e,t,n){return e==null?void 0:t!=null&&!n?f.call(e,0,t):e[0]},N.initial=function(e,t,n){return f.call(e,0,e.length-(t==null||n?1:t))},N.last=function(e,t,n){return e==null?void 0:t!=null&&!n?f.call(e,Math.max(e.length-t,0)):e[e.length-1]},N.rest=N.tail=N.drop=function(e,t,n){return f.call(e,t==null||n?1:t)},N.compact=function(e){return N.filter(e,N.identity)};var M=function(e,t,n){return C(e,function(e){N.isArray(e)?t?a.apply(n,e):M(e,t,n):n.push(e)}),n};N.flatten=function(e,t){return M(e,t,[])},N.without=function(e){return N.difference(e,f.call(arguments,1))},N.uniq=N.unique=function(e,t,n,r){N.isFunction(t)&&(r=n,n=t,t=!1);var i=n?N.map(e,n,r):e,s=[],o=[];return C(i,function(n,r){if(t?!r||o[o.length-1]!==n:!N.contains(o,n))o.push(n),s.push(e[r])}),s},N.union=function(){return N.uniq(l.apply(s,arguments))},N.intersection=function(e){var t=f.call(arguments,1);return N.filter(N.uniq(e),function(e){return N.every(t,function(t){return N.indexOf(t,e)>=0})})},N.difference=function(e){var t=l.apply(s,f.call(arguments,1));return N.filter(e,function(e){return!N.contains(t,e)})},N.zip=function(){var e=f.call(arguments),t=N.max(N.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=N.pluck(e,""+r);return n},N.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},N.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=N.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(w&&e.indexOf===w)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},N.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(E&&e.lastIndexOf===E)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},N.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var _=function(){};N.bind=function(e,t){var n,r;if(e.bind===T&&T)return T.apply(e,f.call(arguments,1));if(!N.isFunction(e))throw new TypeError;return n=f.call(arguments,2),r=function(){if(this instanceof r){_.prototype=e.prototype;var i=new _;_.prototype=null;var s=e.apply(i,n.concat(f.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(f.call(arguments)))}},N.bindAll=function(e){var t=f.call(arguments,1);return t.length==0&&(t=N.functions(e)),C(t,function(t){e[t]=N.bind(e[t],e)}),e},N.memoize=function(e,t){var n={};return t||(t=N.identity),function(){var r=t.apply(this,arguments);return N.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},N.delay=function(e,t){var n=f.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},N.defer=function(e){return N.delay.apply(N,[e,1].concat(f.call(arguments,1)))},N.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,f<=0?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},N.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},N.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},N.wrap=function(e,t){return function(){var n=[e];return a.apply(n,arguments),t.apply(this,n)}},N.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},N.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},N.keys=x||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)N.has(e,n)&&(t[t.length]=n);return t},N.values=function(e){var t=[];for(var n in e)N.has(e,n)&&t.push(e[n]);return t},N.pairs=function(e){var t=[];for(var n in e)N.has(e,n)&&t.push([n,e[n]]);return t},N.invert=function(e){var t={};for(var n in e)N.has(e,n)&&(t[e[n]]=n);return t},N.functions=N.methods=function(e){var t=[];for(var n in e)N.isFunction(e[n])&&t.push(n);return t.sort()},N.extend=function(e){return C(f.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},N.pick=function(e){var t={},n=l.apply(s,f.call(arguments,1));return C(n,function(n){n in e&&(t[n]=e[n])}),t},N.omit=function(e){var t={},n=l.apply(s,f.call(arguments,1));for(var r in e)N.contains(n,r)||(t[r]=e[r]);return t},N.defaults=function(e){return C(f.call(arguments,1),function(t){if(t)for(var n in t)e[n]==null&&(e[n]=t[n])}),e},N.clone=function(e){return N.isObject(e)?N.isArray(e)?e.slice():N.extend({},e):e},N.tap=function(e,t){return t(e),e};var D=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof N&&(e=e._wrapped),t instanceof N&&(t=t._wrapped);var i=c.call(e);if(i!=c.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=D(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(N.isFunction(a)&&a instanceof a&&N.isFunction(f)&&f instanceof f))return!1;for(var l in e)if(N.has(e,l)){o++;if(!(u=N.has(t,l)&&D(e[l],t[l],n,r)))break}if(u){for(l in t)if(N.has(t,l)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};N.isEqual=function(e,t){return D(e,t,[],[])},N.isEmpty=function(e){if(e==null)return!0;if(N.isArray(e)||N.isString(e))return e.length===0;for(var t in e)if(N.has(e,t))return!1;return!0},N.isElement=function(e){return!!e&&e.nodeType===1},N.isArray=S||function(e){return c.call(e)=="[object Array]"},N.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){N["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),N.isArguments(arguments)||(N.isArguments=function(e){return!!e&&!!N.has(e,"callee")}),typeof /./!="function"&&(N.isFunction=function(e){return typeof e=="function"}),N.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},N.isNaN=function(e){return N.isNumber(e)&&e!=+e},N.isBoolean=function(e){return e===!0||e===!1||c.call(e)=="[object Boolean]"},N.isNull=function(e){return e===null},N.isUndefined=function(e){return e===void 0},N.has=function(e,t){return h.call(e,t)},N.noConflict=function(){return n._=r,this},N.identity=function(e){return e},N.times=function(e,t,n){var r=Array(e);for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},N.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=N.invert(P.escape);var H={escape:new RegExp("["+N.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+N.keys(P.unescape).join("|")+")","g")};N.each(["escape","unescape"],function(e){N[e]=function(t){return t==null?"":(""+t).replace(H[e],function(t){return P[e][t]})}}),N.result=function(e,t){if(e==null)return null;var n=e[t];return N.isFunction(n)?n.call(e):n},N.mixin=function(e){C(N.functions(e),function(t){var n=N[t]=e[t];N.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),q.call(this,n.apply(N,e))}})};var B=0;N.uniqueId=function(e){var t=""+ ++B;return e?e+t:t},N.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;N.template=function(e,t,n){n=N.defaults({},n,N.templateSettings);var r=new RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){return s+=e.slice(i,u).replace(I,function(e){return"\\"+F[e]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),i=u+t.length,t}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,N);var a=function(e){return o.call(this,e,N)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},N.chain=function(e){return N(e).chain()};var q=function(e){return this._chain?N(e).chain():e};N.mixin(N),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];N.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],q.call(this,n)}}),C(["concat","join","slice"],function(e){var t=s[e];N.prototype[e]=function(){return q.call(this,t.apply(this._wrapped,arguments))}}),N.extend(N.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),e.exports}({},{}),r=function(e,t){return e.exports=t,t.WORKER_PROVIDER_MESSAGE_TYPE={register:1,"worker message":2,"worker spawned":3,"worker dead":4,available:5,unavailable:6,"kill worker":7,"spawn worker":8,"start heartbeats":9,heartbeat:10,unresponsive:11,responsive:12,dead:13},t.MONITOR_MESSAGE_TYPE={"new worker provider":0,"worker provider message":1},e.exports}({},{}),i=function(e,t){return e.exports=t,function(e){"use strict";function t(){}function i(e,t){if(r)return t.indexOf(e);var n=t.length;while(n--)if(t[n]===e)return n;return-1}var n=t.prototype,r=Array.prototype.indexOf?!0:!1;n.getListeners=function(e){var t=this._events||(this._events={});return t[e]||(t[e]=[])},n.addListener=function(e,t){var n=this.getListeners(e);return i(t,n)===-1&&n.push(t),this},n.on=n.addListener,n.removeListener=function(e,t){var n=this.getListeners(e),r=i(t,n);return r!==-1&&(n.splice(r,1),n.length===0&&(this._events[e]=null)),this},n.off=n.removeListener,n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,n){var r,i,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if(typeof t=="object")for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&(typeof i=="function"?s.call(this,r,i):o.call(this,r,i));else{r=n.length;while(r--)s.call(this,t,n[r])}return this},n.removeEvent=function(e){return e?this._events[e]=null:this._events=null,this},n.emitEvent=function(e,t){var n=this.getListeners(e),r=n.length,i;while(r--)i=t?n[r].apply(null,t):n[r](),i===!0&&this.removeListener(e,n[r]);return this},n.trigger=n.emitEvent,typeof define=="function"&&define.amd?define(function(){return t}):e.EventEmitter=t}(t),t.EventEmitter.prototype.emit=function(e,n){t.EventEmitter.prototype.trigger.call(this,e,[n])},e.exports}({},{}),s=function(e,t){return e.exports=t,t.noop=function(){},e.exports}({},{}),o=function(e,t){e.exports=t;var r=n,o=i.EventEmitter,u=s;window.iframeSockets={};var a=function(){this.pendingMessages=[],this.message=this.message.bind(this),this.api=this.postMessage.bind(this),this.api.onMessage=u.noop,this.ready=r.once(this.ready.bind(this))};a.prototype.onPostMessage=u.noop,a.prototype.isReady=!1,a.prototype.postMessage=function(e){this.onPostMessage(e)},a.prototype.ready=function(){this.isReady=!0,r.each(this.pendingMessages,this.message)},a.prototype.message=function(e){this.isReady?this.api.onMessage(e):this.pendingMessages.push(e)},t.create=function(e,t){var n=new f(e);return n};var f=function(e){this.id=e,this.iframe=document.createElement("IFRAME"),this.iframe.className="queen-worker",document.body.appendChild(this.iframe),this.kill=r.once(r.bind(this.kill,this)),this.start=r.once(r.bind(this.start,this)),this.emitter=new o,this.pendingMessages=[],this.socket=new a,this.socket.onPostMessage=r.bind(this.postMessageFromWorker,this),this.socket.api.kill=this.kill,window.iframeSockets[this.id]=this.socket.api,this.postMessage=this.socket.message,this.api=l.call(this)},l=function(){var e={};return e.id=this.id,e.on=r.bind(this.emitter.on,this.emitter),e.removeListener=r.bind(this.emitter.removeListener,this.emitter),kill=this.kill,e};f.prototype.postMessageFromWorker=function(e){this.emitter.emit("message",e)},f.prototype.start=function(e){var t=e.run;typeof t=="string"?this.loadUrl(t):t.length?this.runScripts(t):this.kill()};var c='<script>window.queenSocket = window.parent.iframeSockets["QUEEN_SOCKET_ID"];window.alert = function(){};window.confirm = function(){return false;};window.prompt = function(){return null;};</script>';return f.prototype.runScripts=function(e){var t=this,n,i,s;n=this.iframe,i=n.contentDocument?n.contentDocument:n.contentWindow.document,s="<html><head><title></title></head><body>",s+=c.replace("QUEEN_SOCKET_ID",this.id),r.each(e,function(e){s+='<script type="text/javascript" src="'+e+'"></script>'}),s+="<script></script>",this.waitForIframeToLoad(),i.open(),i.write(s),i.close()},f.prototype.loadUrl=function(e){var t=this.iframe,n=t.contentDocument?t.contentDocument:t.contentWindow.document;t.src=e+"?queenSocketId="+this.id,this.waitForIframeToLoad()},f.prototype.waitForIframeToLoad=function(){function n(){e.socket.ready()}var e=this,t=this.iframe;this.iframeWindow=t.contentWindow,t.attachEvent?t.onreadystatechange=function(){e.iframe.readyState=="complete"&&n()}:this.iframe.onload=n},f.prototype.kill=function(e){delete window.iframeSockets[this.id],document.body.removeChild(this.iframe),this.iframe=void 0,this.emitter.emit("dead",e)},e.exports}({},{}),u=function(u,a){u.exports=a,t,e;var f=n,l=i.EventEmitter,c=o.create,h=s,p=r.WORKER_PROVIDER_MESSAGE_TYPE;window.io=io,u.exports=function(e,t){t=t||{};var n=t.env||window,r=io.connect(e,{"max reconnection attempts":Infinity,"reconnection limit":6e4}),i=new v(r);return t.workerTimeout&&(i.workerTimeout=t.workerTimeout),t.maxWorkerCount&&(i.maxWorkerCount=t.maxWorkerCount),t.logger&&(i.log=t.logger),i.api};var d=function(){var e={};return e.on=f.bind(this.emitter.on,this.emitter),e.removeListener=f.bind(this.emitter.removeListener,this.emitter),e.kill=this.kill,e.attributes=this.attributes,e},v=function(e){var t=this;this.emitter=new l,this.socket=e,this.workers={},this.kill=f.once(f.bind(this.kill,this)),this.workerCount=0,e.on("connect",f.bind(this.connectionHandler,this)),e.on("message",f.bind(this.messageHandler,this)),e.on("disconnect",f.bind(this.disconnectionHandler,this)),this.attributes={populatorClientId:this.getClientId(),userAgent:navigator.userAgent,capabilities:{}},f.each(Modernizr,function(e,n){!f.isFunction(e)&&!f.isArray(e)&&n!=="_version"&&(t.attributes.capabilities[n]=e)}),this.api=d.call(this)};return v.prototype.maxWorkerCount=100,v.prototype.workerTimeout=Infinity,v.prototype.log=h.noop,v.prototype.getClientId=function(){var e=window.location.search.match(/(?:\?|\&)clientId=(.*)(?:\&|$)/);return e?e[1]:void 0},v.prototype.kill=function(){this.destroyWorkers(),this.emitter.emit("dead"),this.socket=void 0,this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),delete this.heartbeatTimer)},v.prototype.sendToSocket=function(e){this.socket.send(JSON.stringify(e))},v.prototype.connectionHandler=function(){this.isReconnecting?window.location.reload(!0):(this.log("Connected"),this.emitter.emit("connect"),this.startHeartbeats(),this.register())},v.prototype.startHeartbeats=function(e){function n(){t.sendToSocket([p.heartbeat])}var t=this;this.heartbeatTimer=setInterval(n,e)},v.prototype.messageHandler=function(e){e=JSON.parse(e);switch(e[0]){case p["start heartbeats"]:this.startHeartbeats(e[1]);break;case p["worker message"]:this.workerMessageHandler(e[1],e[2]);break;case p["spawn worker"]:this.spawnWorkerHandler(e[1],e[2]);break;case p["kill worker"]:this.killWorkerHandler(e[1])}},v.prototype.workerMessageHandler=function(e,t){var n=this.workers[e];if(n===void 0)return;n.postMessage(t)},v.prototype.spawnWorkerHandler=function(e,t){this.log("Spawning Worker");var n=this,r=t.timeout,i,s;if(this.workerCount>=this.maxWorkerCount){this.log("Max worker count reached, can't spawn additional workers");return}i=c(e),this.workers[e]=i,t.timeout&&t.timeout<this.workerTimeout?s=setTimeout(function(){i.kill("timeout")},t.timeout):this.workerTimeout!==Infinity&&this.workerTimeout!==void 0&&(s=setTimeout(function(){i.kill("timeout")},this.workerTimeout)),i.api.on("message",function(t){n.sendToSocket([p["worker message"],e,t])}),i.api.on("dead",function(t){s!==void 0&&clearTimeout(s),delete n.workers[e],n.workerCount--,n.workerCount===n.maxWorkerCount-1&&(n.sendToSocket([p.available]),n.emitter.emit("available")),n.emitter.emit("workerDead",e),n.sendToSocket([p["worker dead"],e,t])}),this.workerCount++,this.workerCount===this.maxWorkerCount&&(n.sendToSocket([p.unavailable]),this.emitter.emit("unavailable")),this.sendToSocket([p["worker spawned"],e]),i.start(t),n.emitter.emit("worker",i.api)},v.prototype.killWorkerHandler=function(e){var t=this.workers[e];if(t===void 0)return;t.kill()},v.prototype.disconnectionHandler=function(){this.log("Disconnected"),this.emitter.emit("disconnect"),this.destroyWorkers(),this.isReconnecting=!0,this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),delete this.heartbeatTimer)},v.prototype.destroyWorkers=function(){f.each(this.workers,function(e){e.kill()}),this.workers={},this.workerCount=0},v.prototype.register=function(){this.sendToSocket([p.register,this.attributes])},u.exports}({},{});return u}();